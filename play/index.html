<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Math Sprint</title>
  <link rel="stylesheet" href="../style.css" />
  <link rel="manifest" href="../manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="apple-touch-icon" href="../img/gabriel.png">
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.39/Tone.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
</head>
<body>

<main id="ready-screen" class="screen" role="region" aria-labelledby="ready-heading">
  <h1 id="ready-heading">Math Sprint</h1>
  <div id="audio-loading-spinner" class="audio-loading-spinner" aria-live="polite">
    <span class="spinner"></span>
    <p>Loading audio...</p>
  </div>
  <button id="begin-btn">Loading Audio...</button>
  <div id="audio-loading-banner" class="hidden audio-loading-banner" role="alert" aria-live="polite">
    <p>ðŸŽµ Audio is still loading in the background, but the game is ready to play!</p>
  </div>
</main>

<main id="main-menu" class="screen hidden" role="region" aria-labelledby="main-menu-heading">
  <h1 id="main-menu-heading">Main Menu</h1>
  
  <button id="sprint-mode-btn">
    Sprint Mode
    <span class="btn-subtitle">(60 Seconds)</span>
  </button>
  
  <button id="endless-mode-btn">
    Endless Mode
    <span class="btn-subtitle">(3 Strikes)</span>
  </button>
  
  <button id="survival-mode-btn" style="border: 2px solid #d32f2f; color: #d32f2f;">
    Survival Mode
    <span class="btn-subtitle">(Danger!)</span>
  </button>
  
  <button id="shop-btn">The Shop âš¡</button>
  <button id="settings-btn">Settings</button>
</main>

<main id="shop-screen" class="screen hidden" role="region" aria-labelledby="shop-heading">
    <h1 id="shop-heading">The Shop</h1>
    
  <div class="currency-display">
    âš¡ <span id="wallet-balance">0</span> Sparks
  </div>
  <div id="shop-live" class="sr-only" aria-live="polite" aria-atomic="true"></div>
    
  <div class="shop-grid" id="shop-grid" aria-label="Shop items"></div>
    
    <button id="back-to-menu-shop-btn">Back to Menu</button>
</main>

<main id="game-screen" class="screen hidden" role="region" aria-labelledby="game-heading">
  
  <div id="countdown-overlay" class="hidden" role="alert" aria-live="assertive">
    <span id="countdown-text">3</span>
  </div>

  <form id="game-form" class="game-container">
    <h1 id="game-heading" class="sr-only">Game</h1>
    
    <div id="gabriel-container" aria-hidden="true">
        <div id="gabriel-sprite"></div>
    </div>

    <div id="problem" aria-live="polite"></div>
    <label for="answer" id="answer-label" class="sr-only">Your answer:</label>
    <input type="tel" id="answer" inputmode="numeric" aria-labelledby="answer-label" required />
    <button id="submit">Submit</button>
    <div id="quick-use-bar" class="quick-use-bar" aria-label="Quick use items"></div>
    
    <div id="feedback" role="alert" style="min-height: 1.5em;"></div>
    <div id="item-live" class="sr-only" aria-live="assertive" aria-atomic="true"></div>
    
    <div class="stats-row">
        <div id="score">Score: 0</div>
        <div id="timer">Time: 60s</div>
        <div id="lives" class="hidden">Lives: 3</div>
    </div>
  </form>
</main>

<main id="cash-out-popup" class="screen hidden" role="dialog" aria-modal="true" aria-labelledby="cash-out-heading">
    <h1 id="cash-out-heading">SESSION COMPLETE</h1>
    <div id="cash-out-sparks" style="font-size: 2rem; margin: 1rem 0; color: #ffab00; font-weight: bold;">
        +0 SPARKS
    </div>
    <button id="cash-out-close">Bank It!</button>
</main>

<main id="game-over-screen" class="screen hidden" role="region" aria-labelledby="game-over-heading">
  <h1 id="game-over-heading">Game Over</h1>
  <p>Your Final Score:</p>
  <h2 id="final-score">0</h2>
  <div id="score-breakdown">
    <p>Problems: <span id="problems-answered">0</span></p>
    <p>Correct: <span id="correct-answers">0</span></p>
    <p>Accuracy: <span id="accuracy">0%</span></p>
  </div>
  <button id="play-again-btn">Play Again</button>
  <button id="main-menu-game-over-btn">Main Menu</button>
</main>

<main id="high-score-screen" class="screen hidden" role="region" aria-labelledby="high-score-heading">
  <h1 id="high-score-heading">New High Score!</h1>
  <h2 id="new-high-score">0</h2>
  <button id="play-again-high-score-btn">Play Again</button>
  <button id="main-menu-high-score-btn">Main Menu</button>
  <button id="score-breakdown-btn">See Breakdown</button>
</main>

<main id="settings-screen" class="screen hidden" role="dialog" aria-modal="true" aria-labelledby="settings-heading">
  
  <button id="back-to-menu-btn" class="back-button" aria-label="Back to Main Menu">&larr; Back</button>
  
  <h1 id="settings-heading">Settings</h1>

  <div class="tab-list" role="tablist">
    <button id="tab-audio" role="tab" aria-selected="true" aria-controls="tabpanel-audio">Audio</button>
    <button id="tab-gameplay" role="tab" aria-selected="false" aria-controls="tabpanel-gameplay">Gameplay</button>
    <button id="tab-accessibility" role="tab" aria-selected="false" aria-controls="tabpanel-accessibility">Accessibility</button>
  </div>

  <div id="tabpanel-audio" role="tabpanel" aria-labelledby="tab-audio">
    <h2>Audio Settings</h2>
    <div class="setting-group">
      <label for="master-volume">Master Volume</label>
      <input type="range" id="master-volume" min="0" max="100" value="100">
    </div>
    <div class="setting-group">
      <label for="music-volume">Music Volume</label>
      <input type="range" id="music-volume" min="0" max="100" value="100">
    </div>
    <div class="setting-group">
      <label for="sfx-volume">SFX Volume</label>
      <input type="range" id="sfx-volume" min="0" max="100" value="100">
    </div>
  </div>

  <div id="tabpanel-gameplay" role="tabpanel" aria-labelledby="tab-gameplay" class="hidden">
    <h2>Gameplay Settings</h2>
    <fieldset class="setting-group">
      <legend>Math Operations</legend>
      <input type="checkbox" id="op-addition" checked> <label for="op-addition">Addition (+)</label><br>
      <input type="checkbox" id="op-subtraction"> <label for="op-subtraction">Subtraction (-)</label><br>
      <input type="checkbox" id="op-multiplication"> <label for="op-multiplication">Multiplication (Ã—)</label><br>
      <input type="checkbox" id="op-division"> <label for="op-division">Division (Ã·)</label>
    </fieldset>
    <div class="setting-group">
      <input type="checkbox" id="disable-countdown">
      <label for="disable-countdown">Disable Start Countdown</label>
    </div>
  </div>

  <div id="tabpanel-accessibility" role="tabpanel" aria-labelledby="tab-accessibility" class="hidden">
    <h2>Accessibility</h2>
    <div class="setting-group">
      <button id="contrast-toggle-settings">Toggle High Contrast</button>
    </div>
  </div>
</main>

<main id="whats-new-popup" class="screen hidden" role="dialog" aria-modal="true" aria-labelledby="whats-new-heading">
  <div class="popup-content">
    <h1 id="whats-new-heading">Update</h1>
    <p>Loading update notes...</p>
    <ul></ul>
    <button id="close-popup-btn">Let's Play!</button>
  </div>
</main>

<main id="audio-feature-popup" class="screen hidden" role="dialog" aria-modal="true" aria-labelledby="audio-feature-heading">
  <div class="popup-content">
    <h1 id="audio-feature-heading">ðŸŽµ Faster Startup</h1>
    <p>Audio files are loading in the background while you play! This means you can start playing immediately, even on slower connections.</p>
    <p><strong>Pro tip:</strong> Sounds will work perfectly once loaded.</p>
    <button id="audio-feature-close-btn">Got It!</button>
  </div>
</main>

<footer>
  <p>&copy; <span id="copyright-year">2025</span> James Trimble. All rights reserved.</p>
  <p>Music generated by <a href="https://producer.ai/" target="_blank">Producer.ai</a></p>
  <div class="footer-links" style="margin-top: 1rem; font-size: 0.9rem;">
    <a href="../privacy/" style="color: #666; margin: 0 10px; text-decoration: none; border-bottom: 1px dotted #999;">Privacy</a>
    <a href="../credits/" style="color: #666; margin: 0 10px; text-decoration: none; border-bottom: 1px dotted #999;">Credits</a>
    <a href="../feedback/" style="color: #666; margin: 0 10px; text-decoration: none; border-bottom: 1px dotted #999;">Feedback</a>
  </div>
  <p id="version-number">v0.0.0</p>
</footer>

<script src="../js/main.js" type="module"></script>

</body>
</html>
